<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.repository.ChildMapper">

	<select id="getChildrenByUserId" resultType="com.example.demo.vo.Child">
		SELECT
			id,
			user_id,
			name,
			birth_date,
			gender,
			note,
			reg_date,
			update_date
		FROM children
		WHERE user_id = #{userId}
		ORDER BY id DESC
	</select>

	<select id="getChildByIdAndUserId" resultType="com.example.demo.vo.Child">
		SELECT
			id,
			user_id,
			name,
			birth_date,
			gender,
			note,
			reg_date,
			update_date
		FROM children
		WHERE id = #{id}
		  AND user_id = #{userId}
	</select>

	<insert id="writeChild">
		INSERT INTO children
			(user_id, name, birth_date, gender, note, reg_date, update_date)
		VALUES
			(#{userId}, #{name}, #{birthDate}, #{gender}, #{note}, NOW(), NOW())
	</insert>

	<update id="modifyChild">
		UPDATE children
		SET
			name = #{name},
			birth_date = #{birthDate},
			gender = #{gender},
			note = #{note},
			update_date = NOW()
		WHERE id = #{id}
		  AND user_id = #{userId}
	</update>

	<delete id="deleteChild">
		DELETE FROM children
		WHERE id = #{id}
		  AND user_id = #{userId}
	</delete>

</mapper>
